$schema: "http://json-schema.org/draft-07/schema#"
type: object
properties:
  session_id:
    type: string
  start_time:
    type: string
    format: date-time
  end_time:
    type: string
    format: date-time
  initiator_faction:
    type: object
    properties:
      id:
        type: string
      name:
        type: string
    required:
      - id
      - name
  counterpart_faction:
    type: object
    properties:
      id:
        type: string
      name:
        type: string
    required:
      - id
      - name
  transcript:
    type: array
    items:
      $ref: "speaker_turn.yaml"
  intents:
    type: array
    items:
      oneOf:
        - $ref: "proposal.yaml"
        - $ref: "concession.yaml"
        - $ref: "counter_offer.yaml"
        - $ref: "ultimatum.yaml"
  justifications:
    type: array
    items:
      type: object
      properties:
        intent_id:
          type: string
        reasoning:
          type: string
        confidence:
          type: number
          minimum: 0
          maximum: 1
      required:
        - intent_id
        - reasoning
  outcome:
    type: object
    properties:
      result:
        type: string
        enum:
          - success
          - failure
          - partial_success
          - deadlock
      final_relations:
        type: number
        minimum: -100
        maximum: 100
      agreements:
        type: array
        items:
          type: object
          additionalProperties: true
    required:
      - result
  content_safety_report:
    $ref: "content_safety.yaml"
required:
  - session_id
  - start_time
  - end_time
  - initiator_faction
  - counterpart_faction
  - transcript
  - intents
  - outcome
